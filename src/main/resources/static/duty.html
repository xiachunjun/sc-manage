<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta charset="utf-8" />
<title>责任清单</title>

<meta name="description" content="overview &amp; stats" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

<!-- bootstrap & fontawesome -->
<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="assets/css/sc.css" />
<link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />


<link rel="stylesheet" href="assets/css/bootstrap-datepicker3.min.css" />

<!-- ace styles -->
<link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

<!--[if lte IE 9]>
    <link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet"/>
    <![endif]-->
<!--<link rel="stylesheet" href="assets/css/ace-skins.min.css"/>-->
<!--<link rel="stylesheet" href="assets/css/ace-rtl.min.css"/>-->
<!--[if lte IE 9]>
    <link rel="stylesheet" href="assets/css/ace-ie.min.css"/>
    <![endif]-->

<!-- ace settings handler -->
<script src="assets/js/ace-extra.min.js"></script>

<!--[if lte IE 8]>
    <script src="assets/js/html5shiv.min.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->
<style type="text/css">
table.tftable {
	color: #333333;
	width: 100%;
	border: 1px #729ea5;
	border-collapse: collapse;
}

table.tftable th {
	background-color: #acc8cc;
	border: 1px solid #729ea5;
	padding: 8px;
	text-align: center;
}

table.tftable tr {
	background-color: #ffffff;
}

table.tftable td {
	border: 1px solid #729ea5;
	padding: 8px;
}
</style>
</head>
<body class="no-skin">
	<div id="navbar" class="navbar navbar-default ace-save-state">
		<div class="navbar-container ace-save-state" id="navbar-container">
			<div class="navbar-header pull-left">
				<a href="index.html" class="navbar-brand"> <small> CSSC MARIC 中国船舶及海洋工程设计研究院“晒态势、促提升”信息系统</small>
				</a>
			</div>
			<div class="navbar-buttons navbar-header pull-right" role="navigation">
				<ul class="nav ace-nav">
					<li><span class="cursor-pointer"><img class="nav-user-photo" src="assets/images/u57.png" /> <span class="user-info" id="userName"></span></span> <span class="cursor-pointer"><img class="nav-user-photo" src="assets/images/u59.png" /></span><span id="logoutBtn" class="cursor-pointer"><img
							class="nav-user-photo" src="assets/images/u61.png" /></span></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="main-container ace-save-state" id="main-container">
		<script type="text/javascript">
        try {
            ace.settings.loadState('main-container')
        } catch (e) {
        }
    </script>

		<div id="sidebar" class="sidebar  responsive  ace-save-state">
			<script type="text/javascript">
            try {
                ace.settings.loadState('sidebar')
            } catch (e) {
            }
        </script>
			<ul class="nav nav-list">
				<li class="center active open"><a href="#" class="dropdown-toggle" style="background-color: #0A467F;color: white;"> <span class="menu-text">责任晒板</span>
				</a>
					<ul class="submenu">
						<li class="active"><a href="duty.html"> 责任清单 </a></li>

						<li class=""><a href="bylaws.html"> 规章制度 </a></li>

						<li class=""><a href="#"> 计划完成情况 </a></li>
						<li class=""><a href="#"> 绩效考核 </a></li>
					</ul></li>
				<li class="center"><a href="#" class="dropdown-toggle" style="background-color: #0A467F;color: white;"> <span class="menu-text">任务晒板</span>
				</a>
					<ul class="submenu">
						<li class=""><a href="#"> 任务新建 </a></li>

						<li class=""><a href="#"> 任务执行 </a></li>

						<li class=""><a href="#"> 任务归档 </a></li>
						<li class=""><a href="#"> 任务统计 </a></li>
					</ul></li>
				<li class="center"><a href="#" class="dropdown-toggle" style="background-color: #0A467F;color: white;"> <span class="menu-text">数据晒板</span>
				</a>
					<ul class="submenu">
						<li class=""><a href="#"> 总体经营数据 </a></li>

						<li class=""><a href="#"> 部门监管数据 </a></li>
						<li class=""><a href="#"> 数据填报 </a></li>
					</ul></li>
			</ul>
		</div>

		<div class="main-content">
			<div class="main-content-inner">
				<div class="breadcrumbs ace-save-state">
					<div class="row">
						<div class="col-sm-12" style="font-size: 13px;padding-left: 20px;">
							<div class="col-sm-6 pull-left">
								<span>当前位置</span> > <span>责任晒板</span> > <span>规章制度</span>
							</div>
							<div class="col-sm-6 text-right" style="padding-right: 20px;">
								<button class="btn btn-white radius-4">编辑</button>
							</div>
						</div>
					</div>
				</div>
				<div class="page-content">
					<div class="row">
						<div class="col-xs-12">
							<div class="row">
								<div class="space-6"></div>
								<div class="col-sm-12 center">
									<div class="space-6"></div>
									<form id="queryForm" class="form-horizontal" role="form">
										<div class="form-group">
											<label class="col-sm-2 control-label no-padding-right" for="departmentCode">部门</label>
											<div class="col-sm-2">
												<select style="width: 80%;" id="departmentCode" name="departmentCode">
												
												</select>
											</div>
											<label class="col-sm-1 control-label no-padding-right" for="bylawsCategory">岗位</label>
											<div class="col-sm-2">
												<select style="width: 80%;" id="bylawsCategory" name="bylawsCategory">
													<option></option>
													<option value="XZGL">行政管理</option>
													<option value="TJBZ">条件保障</option>
													<option value="CWGL">财务管理</option>
												</select>
											</div>
											<label class="col-sm-1 control-label no-padding-right" for="bylawsCategory">责任人</label>
											<div class="col-sm-2">
												<select style="width: 80%;" id="bylawsCategory" name="bylawsCategory">
													<option></option>
													<option value="XZGL">行政管理</option>
													<option value="TJBZ">条件保障</option>
													<option value="CWGL">财务管理</option>
												</select>
											</div>
											<div class="col-sm-2 align-left">
												<button class="btn btn-white radius-4" style="padding: 4px 12px;">查询</button>
											</div>
										</div>
									</form>
								</div>
							</div>
							<div class="row">
								<div class="space-6"></div>
								<div class="col-sm-12 center">
									<div style="font-size: 18px; font-weight: bold;">部门与岗位责任清单</div>
									<div class="space-6"></div>
									<table id="tfhover" class="tftable" border="1">
										<tr>
											<th>序号</th>
											<th>部门名称</th>
											<th>岗位名称</th>
											<th>责任人</th>
										</tr>
										<tr class="center">
											<td>1</td>
											<td>行政管理总则1</td>
											<td>XZGL00000001</td>
											<td>AAAA0000001</td>
										</tr>
										<tr class="center">
											<td>1</td>
											<td>行政管理总则1</td>
											<td>XZGL00000001</td>
											<td>AAAA0000001</td>
										</tr>
										<tr class="center">
											<td>1</td>
											<td>行政管理总则1</td>
											<td>XZGL00000001</td>
											<td>AAAA0000001</td>
										</tr>
										<tr class="center">
											<td>1</td>
											<td>行政管理总则1</td>
											<td>XZGL00000001</td>
											<td>AAAA0000001</td>
										</tr>
									</table>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="footer">
			<div class="footer-inner">
				<div class="footer-content">
					<span class="white">版权所有：北京中船信息科技有限公司</span>
				</div>
			</div>
		</div>
	</div>
	<script src="assets/js/jquery-2.1.4.min.js"></script>
	<!--[if IE]>
<script src="assets/js/jquery-1.11.3.min.js"></script>
<![endif]-->
	<script type="text/javascript">
    if ('ontouchstart' in document.documentElement)
        document
            .write("<script src='assets/js/jquery.mobile.custom.min.js'>"
                + "<" + "/script>");
</script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/jquery.form.js"></script>


	<!-- ace scripts -->
	<script src="assets/js/ace.min.js"></script>
	<script src="assets/js/bootstrap-datepicker.min.js"></script>
	<script src="assets/js/ace-elements.min.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {
			$.ajax({
				type : 'POST',
				url : '/user/currentUser',
				data : null,
				headers : {
					'Content-Type' : 'application/json'
				},
				success : function(data) {
					var resultCode = data.resultCode;
					var dataMap = data.dataMap;
					if (resultCode == '000000' & dataMap != null) {
						var userLoginName = dataMap.userLoginName;
						$("#userName").html(userLoginName);
					} else {
						window.location.href = "login.html";
					}
				},
				dataType : 'json',
				error : function(data) {
					alert("获取登录信息异常-" + JSON.stringify(data));
				}
			});
		});
		$("#logoutBtn").on('click', function(e) {
				$.ajax({
					type : 'POST',
					url : '/user/logout',
					data : null,
					headers : {
						'Content-Type' : 'application/json'
					},
					success : function(data) {
						var resultCode = data.resultCode;
						var dataMap = data.dataMap;
						if (resultCode == '000000') {
							window.location.href = "login.html";
						}
					},
					dataType : 'json',
					error : function(data) {
						alert("获取登录信息异常-" + JSON.stringify(data));
					}
				});
			});
			
			function queryData() {
			
			
			
			$.ajax({
				type : 'POST',
				url : '/bylaw/query/list',
				data : null,
				headers : {
					'Content-Type' : 'application/json'
				},
				success : function(data) {
					var resultCode = data.resultCode;
					var dataMap = data.dataMap;
					if (resultCode == '000000' & dataMap != null) {
						dataListRender(dataMap);
					} else {
						alert(11);
					}
				},
				dataType : 'json',
				error : function(data) {
					alert("获取登录信息异常-" + JSON.stringify(data));
				}
			});
		}
	
	
		function dataListRender(dataMap) {
			var ht = "<tr><th>序号</th><th>名称</th><th>编号</th><th>发文文号</th><th>发文时间</th></tr>";
			var cwglList = dataMap.CWGL;
			var tjbzList = dataMap.TJBZ;
			var xzglList = dataMap.XZGL;
			if (xzglList && xzglList.length > 0) {
				var indexNo = 1;
				ht = ht + "<tr><td colspan='5'>一、行政管理</td></tr>";
				for (var i = 0; i < xzglList.length; i++) {
					var xzgl = xzglList[i];
					ht = ht + "<tr class='center'><td>" + (indexNo++) + "</td>";
					ht = ht + "<td><a href='/bylaw/download?bylawsId="+xzgl.id+"'>" + xzgl.bylawsName + "</a></td>>";
					ht = ht + "<td>" + xzgl.bylawsNo + "</td>";
					ht = ht + "<td>" + xzgl.articleNo + "</td>";
					ht = ht + "<td>" + formatDate(xzgl.articleTime) + "</td>";
				}
			}
			if (tjbzList && tjbzList.length > 0) {
				var indexNo = 1;
				ht = ht + "<tr><td colspan='5'>二、条件保障</td></tr>";
				for (var i = 0; i < tjbzList.length; i++) {
					var tjbz = tjbzList[i];
					ht = ht + "<tr class='center'><td>" + (indexNo++) + "</td>";
					ht = ht + "<td><a href='/bylaw/download?bylawsId="+xzgl.id+"'>" + tjbz.bylawsName + "</a></td>";
					ht = ht + "<td>" + tjbz.bylawsNo + "</td>";
					ht = ht + "<td>" + tjbz.articleNo + "</td>";
					ht = ht + "<td>" + formatDate(tjbz.articleTime) + "</td>";
				}
			}
			if (cwglList && cwglList.length > 0) {
				var indexNo = 1;
				ht = ht + "<tr><td colspan='5'>三、财务管理</td></tr>";
				for (var i = 0; i < cwglList.length; i++) {
					var cwgl = cwglList[i];
					ht = ht + "<tr class='center'><td>" + (indexNo++) + "</td>";
					ht = ht + "<td><a href='/bylaw/download?bylawsId="+xzgl.id+"'>" + cwgl.bylawsName + "</a></td>>";
					ht = ht + "<td>" + cwgl.bylawsNo + "</td>";
					ht = ht + "<td>" + cwgl.articleNo + "</td>";
					ht = ht + "<td>" + formatDate(cwgl.articleTime) + "</td>";
				}
			}
			$("#tfhover").html(ht);
		}
		
		
		function   formatDate(timestampStr)   {
			  var   now=new   Date(timestampStr);      
              var   year=now.getYear();     
              var   month=now.getMonth()+1;     
              var   date=now.getDate();     
              /* var   hour=now.getHours();     
              var   minute=now.getMinutes();     
              var   second=now.getSeconds();  */    
              return   (1900+year)+"年"+month+"月"+date+"日";     
         }   
			
	</script>


	<script type="text/javascript">
    jQuery(function ($) {
        $('.date-picker').datepicker({
            autoclose: true,
            todayHighlight: true
        })
            .next().on(ace.click_event, function () {
            $(this).prev().focus();
        })
        $('#file-upload').ace_file_input({
            no_file: '未选择文件',
            btn_choose: '选择文件',
            btn_change: '重新选择',
            droppable: false,
            onchange: null,
            thumbnail: false //| true | large
            //whitelist:'gif|png|jpg|jpeg'
            //blacklist:'exe|php'
            //onchange:''
            //
        });
    });

</script>

	<script type="text/javascript">
    //表单提交事件
    $('#addBylawsForm').submit(function () {
        $("#addBylawsForm").ajaxSubmit({
            url: "/bylaw/save",
            type: "POST",
            dataType: "JSON",
            clearForm: true,
            resetForm: true,
            timeout: 5000,
            success: function (respData) {
                if('000000'===respData.resultCode){
                    alert("保存成功");
                }else {
                    alert("保存失败,稍后重试...");
                }
                $('.remove').click();
            },
            beforeSubmit: function (formData) {
                console.log(formData);
            }
        });
        return false;
    })
</script>


</body>
</html>
